<!doctype html>
<html lang="pt-BR">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  
  <link rel="icon" type="image/png" href="logo-dark.png">
  
  <title>Hells Angels</title>
  
  <link rel="stylesheet" href="style.css">
</head>
<body class="light">
  
  <a href="#" id="logoLink">
    <img id="appLogo" src="logo-dark.png" alt="Hells Angels Logo" class="app-logo">
  </a>

  <div id="welcomeScreen"> 
      <img id="welcomeLogo" src="logo-dark.png" alt="Welcome Logo"> 
      <h2 style="font-weight: 900;">Bem-vindo(a)</h2>
      <p style="margin-bottom: 20px; font-size: 16px;">Calculadora e Registro de Vendas Hells Angels</p>
      <button id="enterBtn" class="primary">Entrar no Site</button>
  </div>
  
  <div class="top-right-controls">
      <button class="control-btn" id="tutorialBtn">üí° Tutorial</button> 
      <button class="control-btn" id="themeBtn">üåô Modo Noturno</button>
      <button class="control-btn" id="investigacaoBtn" style="display:none; background-color: #0056b3;">üîé Investiga√ß√£o</button> 
  </div>

  <div id="authScreen" class="card" style="max-width: 400px; margin: 100px auto 20px auto; display: none;">
      <img src="logo-dark.png" alt="Hells Angels Logo" style="display: block; max-height: 100px; margin: 0 auto 20px auto;">
      <h2>Autentica√ß√£o de Usu√°rio</h2>
      <label for="username">Nome de Usu√°rio:</label>
      <input id="username" type="text" placeholder="Seu nome de usu√°rio">
      <label for="password">Senha:</label>
      <input id="password" type="password" placeholder="Sua senha">
      <div class="actions">
          <button id="loginBtn" class="primary">Entrar</button>
          <button id="registerUserBtn" class="muted">Cadastrar</button>
      </div>
      <a href="#" id="forgotPasswordLink" style="text-align: center; display: block; margin-top: 15px;">Esqueci a Senha</a>
      <p id="authMessage" style="color: var(--cor-erro); margin-top: 10px;"></p>
  </div>

  <div class="card" id="mainCard" style="display:none">
    <div class="header-container">
        <h1 id="mainTitle">Calculadora e Registro de Vendas</h1>
        <span id="userStatus" class="user-status-display" style="display:none;"></span>
        <button id="logoutBtn" class="danger" style="animation: none;">Sair</button>
    </div>
    
    <div class="card-venda">
        <h2>Dados da Venda</h2>
        <div class="grid grid-venda">
            <div>
                <label for="nomeCliente">Nome:</label>
                <input id="nomeCliente" type="text" value="">
            </div>
            <div>
                <label for="dataVenda">Data e Hor√°rio:</label>
                <input id="dataVenda" type="text" readonly> 
            </div>
            <div>
                <label for="organizacao">Organiza√ß√£o:</label>
                <input id="organizacao" type="text" value="" list="sugestoesOrganizacao">
                <p class="suggestion-tip">Digite para ver sugest√µes de organiza√ß√µes.</p>
                <datalist id="sugestoesOrganizacao">
                    <option value="Hells Angels"></option>
                    <option value="Serpents"></option> <option value="Nox"></option> <option value="NKT"></option> <option value="Ruptura"></option> <option value="Midnight"></option> <option value="Meraki"></option> <option value="Lotus"></option> <option value="Hydra"></option> <option value="Hooligans"></option> <option value="Families"></option> <option value="Cartel"></option> <option value="Blood Street"></option> <option value="Blood Reapers"></option> <option value="Blue Diamond"></option> <option value="Black Heart"></option> <option value="Ballas"></option> <option value="Aura"></option> <option value="Anarquia"></option> <option value="8 Anjo"></option> <option value="Vagos"></option> <option value="Vertice"></option> <option value="Void"></option> <option value="Solo"></option>
                </datalist>
            </div>
            <div>
                <label for="organizacaoTipo">Op√ß√£o (CNPJ/CPF):</label>
                <select id="organizacaoTipo">
                    <option value="CNPJ">CNPJ (Obrigat√≥rio)</option>
                    <option value="CPF">CPF (Opcional)</option>
                    <option value="OUTROS">Outros (Opcional)</option>
                </select>
            </div>
            <div>
                <label for="telefone">Telefone:</label>
                <input id="telefone" type="text" value="" maxlength="13"> 
            </div>
            
            <div>
                <label for="negociadoras">Negociadoras:</label>
                <input id="negociadoras" type="text" value="">
            </div>
            
            <div class="grid-venda-3col">
                <div>
                    <label for="carroVeiculo">Carro(s) (Opcional):</label>
                    <input id="carroVeiculo" type="text" value="">
                    <p class="suggestion-tip">Separe m√∫ltiplos com v√≠rgula.</p>
                </div>
                <div>
                    <label for="placaVeiculo">Placa(s) (Opcional):</label>
                    <input id="placaVeiculo" type="text" value="">
                    <p class="suggestion-tip">Separe m√∫ltiplos com v√≠rgula.</p>
                </div>
                <div>
                    <label for="vendaValorObs">Cargo:</label>
                    <input id="vendaValorObs" type="text" value="">
                </div>
            </div>
        </div>
    </div>
    
    <hr style="margin: 20px 0; border: 0; border-top: 1px solid var(--cor-borda);">

    <h2>C√°lculo de Produtos</h2>
    <p class="small">Informe quantos produtos deseja fabricar/vender e escolha o tipo de valor.</p>

    <div class="grid">
      <div>
        <label for="qtyTickets">Quantidade de Tickets</label>
        <input id="qtyTickets" type="number" min="0" value="">
      </div>
      <div>
        <label for="qtyTablets">Quantidade de Tablets</label>
        <input id="qtyTablets" type="number" min="0" value="">
      </div>
      <div>
        <label for="qtyNitro">Quantidade de Nitro</label>
        <input id="qtyNitro" type="number" min="0" value="">
      </div>
      <div>
        <label for="tipoValor">Tipo de Valor</label>
        <select id="tipoValor">
          <option value="limpo">Dinheiro Limpo</option>
          <option value="sujo">Dinheiro Sujo</option>
          <option value="limpo_alianca">Limpo (Alian√ßa)</option>
          <option value="sujo_alianca">Sujo (Alian√ßa)</option>
        </select>
      </div>
    </div>

    <div class="actions">
      <button id="calcBtn" class="primary">Calculular</button>
      <button id="resetBtn" class="muted">Limpar Campos</button>
      <button id="registerBtn" class="success">Registrar Venda</button>
      <button id="toggleHistoryBtn" class="muted">Ver Hist√≥rico</button>
      <button id="csvBtn" class="muted">Exportar CSV</button>
      <button id="discordBtnCalc" class="muted">Discord</button>
      <button id="adminPanelBtn" class="muted" style="display:none; background-color: #ffb3d9;">Painel Admin</button>
    </div>

    <div id="resultsContainer">
      <div id="results" style="margin-top:16px;display:none">
        <h3>Totais necess√°rios</h3>
        <table>
          <thead><tr><th>Material</th><th>Quantidade total</th></tr></thead>
          <tbody id="resultsBody"></tbody>
        </table>
        <h3>Valores Estimados</h3>
        <table>
          <thead><tr><th>Produto</th><th>Valor Total</th></tr></thead>
          <tbody id="valuesBody"></tbody>
          <tfoot>
            <tr><th>Total Geral</th><th id="valorTotalGeral">R$ 0</th></tr>
          </tfoot>
        </table>
        <p class="result-note" style="font-size: 12px; margin-top: 8px;">Os valores variam conforme o tipo selecionado (limpo, sujo, alian√ßa).</p>
      </div>
    </div>
  </div>

  <div class="card" id="adminPanel" style="display:none;">
    <h2>Painel do Administrador (Hierarquia)</h2>
    <div class="actions" style="margin-top: 0; margin-bottom: 15px; justify-content: flex-end;">
      <button id="toggleCalcBtnAdmin" class="muted">Voltar √† Calculadora</button>
    </div>
    
    <h3>Status do Servidor</h3>
    <p style="font-size: 13px;">Usu√°rios online (ativos nos √∫ltimos 60s): <strong id="onlineUsersCount">...</strong></p>
    
    <h3>Gerenciamento de Usu√°rios</h3>
    <p style="font-size: 13px;">Altere a permiss√£o de usu√°rios. Voc√™ n√£o pode alterar sua pr√≥pria tag.</p>
    <div class="history-table-wrapper">
      <table id="adminUserTable">
        <thead>
          <tr>
            <th style="width: 45%;">Usu√°rio (Nome)</th>
            <th style="width: 40%;">Permiss√£o (Tag)</th>
            <th style="width: 15%;">A√ß√µes</th>
          </tr>
        </thead>
        <tbody id="adminUserListBody">
          <tr><td colspan="3" style="text-align: center;">Carregando usu√°rios...</td></tr>
        </tbody>
      </table>
    </div>

    <h3 style="margin-top: 20px;">Controles de Layout Global</h3>
    <p style="font-size: 13px;">Habilite ou desabilite recursos para todos os usu√°rios do site em tempo real.</p>
    <div style="display: flex; flex-direction: column; gap: 10px; margin-top: 10px;">
      <label style="display: flex; align-items: center; gap: 8px; margin: 0;">
        <input type="checkbox" id="layoutToggleNightMode" style="width: auto;"> Habilitar o bot√£o "Modo Noturno" para todos
      </label>
      <label style="display: flex; align-items: center; gap: 8px; margin: 0;">
        <input type="checkbox" id="layoutToggleBottomPanel" style="width: auto;"> Ligar "Painel Inferior" para todos
      </label>
      <div style="margin-top: 15px;">
        <label for="bottomPanelText">Mensagem do Painel Inferior:</label>
        <input type="text" id="bottomPanelText" placeholder="Digite a mensagem para o rodap√© aqui">
        <button id="saveBottomPanelTextBtn" class="primary" style="margin-top: 8px;">Salvar Mensagem</button>
      </div>
    </div>

    <h3 style="margin-top: 20px;">A√ß√µes de Dossi√™</h3>
    <p style="font-size: 13px;">Se voc√™ tem vendas antigas, clique no bot√£o abaixo UMA VEZ para copi√°-las para o novo sistema de Dossi√™.</p>
    <button id="migrateDossierBtn" class="danger" style="animation: none;">Migrar Vendas Antigas para Dossi√™</button>
    <p style="font-size: 13px; margin-top: 15px;">Se voc√™ usava o sistema antigo de Carros/Placas (com v√≠rgulas), clique abaixo UMA VEZ para migrar para o novo gerenciador.</p>
    <button id="migrateVeiculosBtn" class="danger" style="animation: none; background-color: #cc0000;">Migrar Ve√≠culos Antigos (Dossi√™)</button>
  </div>

  <div class="card" id="historyCard" style="display:none">
    <div id="historyBackground" class="card">
      <h2>Hist√≥rico de Vendas Registradas</h2>
      <img id="historyImg" src="logo-dark.png" alt="Fundo Hist√≥rico">
      <input type="text" id="filtroHistorico" placeholder="üîç Pesquisar no hist√≥rico (Nome, Data, Item, etc.)" style="margin-bottom: 10px; width: 100%;">
      <div class="actions">
        <button id="clearHistoryBtn" class="muted">Limpar Hist√≥rico</button>
        <button id="toggleCalcBtn" class="muted">Voltar √† Calculadora</button>
      </div>

      <div class="history-table-wrapper"><table id="historicoVendas">
        <thead>
          <tr>
            <th>Data/Hora</th>
            <th>Cliente</th>
            <th>Organiza√ß√£o/Tipo</th>
            <th>Telefone</th>
            <th>Produtos (Unidade)</th>
            <th>Valor Total</th>
            <th>Negociadoras</th>
            <th>Registrado Por</th>
            <th>A√ß√µes</th>
          </tr>
        </thead>
        <tbody id="salesHistory"></tbody>
      </table></div>
    </div>
  </div>

  <div class="card" id="dossierCard" style="display:none">
    <div id="dossierOrgContainer">
      <h2>Sistema de Investiga√ß√£o (Bases)</h2>
      <div class="actions" style="margin-top: 0; margin-bottom: 10px;">
        <input type="text" id="filtroDossierOrgs" placeholder="üîç Buscar por Base ou Nome de Pessoa..." style="margin: 0; flex-grow: 1;">
        <button id="addOrgBtn" class="success" style="animation: none; margin-left: 10px;">+ Adicionar Base</button>
        <button id="toggleCalcBtnDossier" class="muted">Voltar √† Calculadora</button>
      </div>
      <div id="dossierOrgGrid" class="dossier-org-grid" style="margin-top: 15px;">
        <p>Carregando bases...</p>
      </div>
    </div>

    <div id="dossierPeopleContainer" style="display:none;">
      <div id="dossierPeopleHeader">
        <h2 id="dossierPeopleTitle">Membros</h2>
        <button id="dossierVoltarBtn" class="muted">‚Üê Voltar para Bases</button>
      </div>
      <div class="actions" style="margin-top: 0; margin-bottom: 10px;">
        <input type="text" id="filtroDossierPeople" placeholder="üîç Buscar por Nome, Carro ou Placa(s)..." style="margin: 0; flex-grow: 1;">
        <button id="addPessoaBtn" class="success" style="animation: none; margin-left: 10px;">+ Adicionar Pessoa</button>
      </div>
      <div id="dossierPeopleGrid" class="dossier-people-grid" style="margin-top: 15px;">
        <p>Carregando membros...</p>
      </div>
    </div>
  </div>

  <div id="toast-container"></div>
  <div id="bottomPanel">
    <span id="bottomPanelDisplay">Este √© o painel inferior. O conte√∫do pode ser personalizado.</span>
  </div>

  <div id="editDossierOverlay" class="modal-overlay"></div>
  <div id="editDossierModal" class="card modal-content"> 
    <h2>Editar Entrada do Dossi√™</h2>
    <input type="hidden" id="editDossierOrg">
    <input type="hidden" id="editDossierId">

    <label for="editDossierNome">Nome:</label>
    <input type="text" id="editDossierNome">

    <label for="editDossierNumero">N√∫mero:</label>
    <input type="text" id="editDossierNumero" maxlength="13">

    <label for="editDossierCargo">Cargo:</label>
    <input type="text" id="editDossierCargo">

    <label for="editDossierFotoUrl">Foto URL:</label>
    <input type="text" id="editDossierFotoUrl" placeholder="Cole o link da imagem aqui (ex: https://i.imgur.com/...)">

    <label for="editDossierInstagram">Instagram:</label>
    <input type="text" id="editDossierInstagram" placeholder="@usuario (opcional)">

    <h4 style="margin-top:15px; margin-bottom: 5px; color: var(--cor-principal);">Gerenciador de Ve√≠culos</h4>
    <div class="grid grid-venda" style="gap: 10px;">
      <input type="text" id="editVeiculoNome" placeholder="Nome do carro (ex: Sultan RS)">
      <input type="text" id="editVeiculoPlaca" placeholder="Placa (ex: HA240)">
      <button id="addVeiculoBtnModal" class="success" style="padding: 8px 10px; font-size: 14px; margin: 0; width: 100%;">Adicionar Ve√≠culo</button>
    </div>
    
    <div id="editModalListaVeiculos">
      <p style="text-align: center; font-size: 13px; color: #888;">Nenhum ve√≠culo adicionado.</p>
    </div>
    
    <label for="editDossierObservacoes">Observa√ß√µes:</label>
    <textarea id="editDossierObservacoes" placeholder="Informa√ß√µes extras sobre a pessoa/base."></textarea>

    <div class="actions">
      <button id="saveDossierBtn" class="primary">Salvar Altera√ß√µes</button>
      <button id="deleteDossierBtn" class="danger">Excluir Entrada</button>
      <button id="cancelDossierBtn" class="muted">Cancelar</button>
    </div>
  </div>
  
  <script src="https://www.gstatic.com/firebasejs/8.6.8/firebase-app.js"></script>
  <script src="script.js"></script>
</body>
</html>